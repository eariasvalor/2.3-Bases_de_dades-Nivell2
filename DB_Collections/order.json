{
  "$jsonSchema": {
    "bsonType": "object",
    "required": [
      "customerId",
      "storeId",
      "placedAt",
      "mode",
      "items",
      "total"
    ],
    "properties": {
      "_id": {
        "bsonType": "objectId"
      },
      "customerId": {
        "bsonType": "objectId",
        "description": "Reference to the customer who placed the order"
      },
      "storeId": {
        "bsonType": "objectId",
        "description": "Reference to the store managing the order"
      },
      "placedAt": {
        "bsonType": "date",
        "description": "Date and time when the order was placed"
      },
      "mode": {
        "enum": ["delivery", "pickup"],
        "description": "Specifies whether the order is for home delivery or in-store pickup"
      },
      "items": {
        "bsonType": "array",
        "minItems": 1,
        "items": {
          "bsonType": "object",
          "required": [
            "productId",
            "productName",
            "unitPrice",
            "quantity",
            "subtotal"
          ],
          "properties": {
            "productId": {
              "bsonType": "objectId",
              "description": "Unique identifier of the product"
            },
            "productName": {
              "bsonType": "string",
              "description": "Product name at the time the order was placed"
            },
            "unitPrice": {
              "bsonType": "double",
              "minimum": 0,
              "description": "Unit price of the product at the time of ordering"
            },
            "quantity": {
              "bsonType": "int",
              "minimum": 1,
              "description": "Quantity of this product in the order"
            },
            "subtotal": {
              "bsonType": "double",
              "minimum": 0,
              "description": "Subtotal for this product (unitPrice * quantity)"
            }
          }
        }
      },
      "typeCounts": {
        "bsonType": "object",
        "properties": {
          "pizzas": {
            "bsonType": "int",
            "minimum": 0
          },
          "burgers": {
            "bsonType": "int",
            "minimum": 0
          },
          "drinks": {
            "bsonType": "int",
            "minimum": 0
          }
        },
        "description": "Counts of product types included in the order"
      },
      "total": {
        "bsonType": "double",
        "minimum": 0,
        "description": "Total price of the order"
      },
      "delivery": {
        "bsonType": ["object", "null"],
        "properties": {
          "courierId": {
            "bsonType": "objectId",
            "description": "Employee (courier) assigned to deliver the order"
          },
          "deliveredAt": {
            "bsonType": "date",
            "description": "Date and time when the order was delivered"
          }
        },
        "description": "Delivery details (only used when mode = 'delivery')"
      }
    }
  }
}
